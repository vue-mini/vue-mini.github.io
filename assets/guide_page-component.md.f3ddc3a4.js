import{o as n,c as s,a}from"./app.8efcc44e.js";const o='{"title":"定义页面组件","description":"","frontmatter":{},"headers":[{"level":2,"title":"setup","slug":"setup"},{"level":2,"title":"生命周期","slug":"生命周期"}],"relativePath":"guide/page-component.md","lastUpdated":1622194741202}',t={},p=a('<h1 id="定义页面组件"><a class="header-anchor" href="#定义页面组件" aria-hidden="true">#</a> 定义页面组件</h1><p>小程序支持将组件作为页面使用，本文档称此类组件为<code>页面组件</code>。定义页面组件与定义普通组件没有什么区别，都是使用 <code>defineComponent</code>，只需注意<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/component.html#%E4%BD%BF%E7%94%A8-Component-%E6%9E%84%E9%80%A0%E5%99%A8%E6%9E%84%E9%80%A0%E9%A1%B5%E9%9D%A2" target="_blank" rel="noopener noreferrer">小程序自身的规则</a>。</p><h2 id="setup"><a class="header-anchor" href="#setup" aria-hidden="true">#</a> setup</h2><ul><li><strong>调用顺序</strong></li></ul><p>页面组件也是组件，所以页面组件的 <code>setup</code> 函数会按组件层级优先执行，不会存在晚于子组件 <code>setup</code> 函数执行的情况。所以如果你依赖 <code>setup</code> 的执行顺序，可以使用页面组件。</p><h2 id="生命周期"><a class="header-anchor" href="#生命周期" aria-hidden="true">#</a> 生命周期</h2><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@vue-mini/wechat&#39;</span>\n\n<span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  lifetimes<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;created&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">attached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;attached&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;ready&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">moved</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;moved&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">detached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;detached&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  pageLifetimes<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;show&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hide&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  methods<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onLoad&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onShow&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onReady&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onHide&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onUnload&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onPullDownRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onPullDownRefresh&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onReachBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onReachBottom&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onShareAppMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onShareAppMessage&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onShareTimeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onShareTimeline&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onAddToFavorites</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onAddToFavorites&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onPageScroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onPageScroll&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onResize&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">onTabItemTap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onTabItemTap&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><p>以上是页面组件可用的所有生命周期，可以看到这些生命周期有些混乱，并且很多是重复的。</p><p>Vue Mini 对页面组件的生命周期钩子做了些许整合和简化。同样它们是一族 <code>onXXX</code> 函数，它们接收的参数和返回值与对应的生命周期一致。<code>onPageScroll()</code>、<code>onShareAppMessage()</code>、<code>onShareTimeline()</code> 以及 <code>onAddToFavorites()</code> 的使用限制与页面中一样。</p><ul><li><strong>onLoad</strong></li></ul><p><code>onLoad()</code> 是页面组件特有的生命周期钩子，在页面中使用会抛出一个错误，在普通组件中使用不会有效果。</p><ul><li><p><strong>生命周期对应关系</strong></p><ul><li><code>lifetimes.created</code> -&gt; 无</li><li><code>lifetimes.attached</code> -&gt; <code>setup</code></li><li><code>lifetimes.ready</code> -&gt; <code>onReady</code></li><li><code>lifetimes.moved</code> -&gt; <code>onMove</code></li><li><code>lifetimes.detached</code> -&gt; <code>onDetach</code></li><li><code>lifetimes.error</code> -&gt; <code>onError</code></li><li><code>pageLifetimes.show</code> -&gt; <code>onShow</code></li><li><code>pageLifetimes.hide</code> -&gt; <code>onHide</code></li><li><code>pageLifetimes.resize</code> -&gt; <code>onResize</code></li><li><code>methods.onLoad</code> -&gt; <code>onLoad</code></li><li><code>methods.onShow</code> -&gt; <code>onShow</code></li><li><code>methods.onReady</code> -&gt; <code>onReady</code></li><li><code>methods.onHide</code> -&gt; <code>onHide</code></li><li><code>methods.onUnload</code> -&gt; <code>onUnload</code></li><li><code>methods.onPullDownRefresh</code> -&gt; <code>onPullDownRefresh</code></li><li><code>methods.onReachBottom</code> -&gt; <code>onReachBottom</code></li><li><code>methods.onShareAppMessage</code> -&gt; <code>onShareAppMessage</code></li><li><code>methods.onShareTimeline</code> -&gt; <code>onShareTimeline</code></li><li><code>methods.onAddToFavorites</code> -&gt; <code>onAddToFavorites</code></li><li><code>methods.onPageScroll</code> -&gt; <code>onPageScroll</code></li><li><code>methods.onResize</code> -&gt; <code>onResize</code></li><li><code>methods.onTabItemTap</code> -&gt; <code>onTabItemTap</code></li></ul></li></ul>',12);t.render=function(a,o,t,c,e,u){return n(),s("div",null,[p])};export default t;export{o as __pageData};
